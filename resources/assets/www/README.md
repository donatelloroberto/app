# Mobile Code

1. From the command line:
```sh
npm install -g cordova
cordova create *projectname*
```

2. Clone or download this repo. The contents of this repo should replace the contents of the www/ folder generated by the 
```sh
cordova create
```

command.

## Requirements
- XCode
- Android Studio 2
- Node
- CocoaPods
- Access to LaunchPartner Github account
- Internet access

## Process - Building iOS app locally
Overview:
- open project workspace & set certificates
- build

### Steps:
1. In terminal, navigate to the project root folder and run the following commands in order:
```sh
$ npm install eslint
$ sudo npm install -g cordova
$ cordova platform rm iOS
$ sudo gem install cocoapods
$ pod setup
$ cordova platform add ios
$ cordova plugin remove cordova-plugin-console
```
2. In a Finder window, navigate to myvidster-ios/platforms/ios/ and open the MyVidster.xcworkspace file (should automatically open in XCode).
3. In XCode's Project Navigator view, double click on the MyVidster icon (blue icon @ root) -- this opens a settings page
    - Under the General tab, change Bundle Identifier to com.keystoke.MyVidster
4. Under Signing, change Team to Sterling Smith and add credentials for new Provisioning Profile. Ask Kaitlyn for the LaunchPartner Apple ID to access the Sterling Smith team; you might need to remove an existing certificate, so double-check with Kaitlyn.
5. Click the 'Play' button and the project should build successfully.

After the build is successful an iOS emulator window will open and display the app.

## Process - Building Android app locally
Overview:
- If you haven't already, install cordova (see step 1 in iOS).
- Import to Android Studio, choose a virtual device/emulator, and build.

### Steps:
1. Run
```sh
sudo cordova platform add android@6.4.0
```
2. Open Android Studio and select Import project (Gradle, Eclipse ADT, etc) from myvidster-ios/platforms/android/

    - If you see an error that looks like this: 'Unable to save /Users/sterling/Code/myvidster-ios/platforms/android/local.properties/Users/sterling/Code/myvidster-ios/platforms/android/local.properties (Permission denied)'
        - Run
        ```sh
        sudo chmod -R 777 ./platforms/android
        ```
    - If you see "Failed to find target with hash string 'android-26'"
        - Click SDK manager icon in upper right
        - Click on checkbox beside Android 8.1 (26)
        - Install that
3. Click Cancel to all prompts asking to use/leverage Gradle, and let Android Studio build the project.
4. You will get a Gradle (Gradle Home) error, but that's ok. Click cancel/the option to Fix Gradle and re-import.
5. Let Android Studio re-import and build the project. You should have a successful build and sync now.
6. Click Run (the play button).
7. AVD Manager: when you click run, you will be asked to pick an emulator. Choose the following:
    - Create new Virtual Device
    - Choose a device definition: From the Phone category, select 5.1" WVGA and click Next
    - Select a system image: Select Oreo API Level 26 and click Next
    - Verify configuration:
    - Click Show Advanced Settings; give it 2 GB of RAM, and 32 GB of disk space.
    - Click Finish.
8. Let the project build, sync, and index. You should now have a working Android build.


Alertnative guide for android setup (for Macbook users) 2019/2010:

install android studio (stable version), movie app into application folder 

cordova create [NAME]
cordova platforms add android

First intall jabba to install JDK 8

view [https://adoptopenjdk.net/?variant=openjdk8&jvmVariant=hotspot]

curl -sL https://github.com/shyiko/jabba/raw/master/install.sh | bash && . ~/.jabba/jabba.sh

jabba install adopt@1.8.0-222
brew install gradle

| Android studio: click configure, android sdk manmager -> check android 9 (level 28) install 

export ANDROID_SDK_ROOT=/Users/mac/Library/Android/sdk
export ANDROID_HOME=/Users/mac/Library/Android/sdk

export ANDROID_HOME=/Android/sdk export PATH=$ANDROID_HOME/platform-tools:$PATH export PATH=$ANDROID_HOME/tools:$PATH

ANDROID_HOME= /Users/${user_name}/Library/Android/sdk
export PATH=${PATH}:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools

cordova build android [generates apk]
cordova run --emulator


# iOS app install 2020 Xcode 10 [Cordova 5] by Seb
```sh
$ xcode-select --install
$ sudo npm install -g cordova
$ cordova platform rm iOS
$ sudo gem install -n /usr/local/bin cocoapods:1.1.1
$ pod setup
$ npm install cordova-ios@5.0.0
$ cordova platform add ios@5.0.0
$ cordova plugin remove cordova-plugin-console
$ cordova plugin remove phonegap-plugin-push
$ cordova plugin add phonegap-plugin-push@2.1.2
$ pod setup; pod install;
$ 1) Go to ../platforms/ios/ and open the MyVidster.xcworkspace
$ 2) In MyVidster, select Target file, build settings, search for "No common blocks", select "No"
$ 3) In Plugins folder, go to CDVAmazonMobileAds.m, remove line with "self writeJavascript", replace with: [self.commandDelegate evalJs: [NSString stringWithFormat:@"%@.fire('%@')", kPluginName, escapedEventString]];
$ 4) Be sure all app icons are correctly added, and launch screen storyboard has splash screen image added via xcode
$ 5) Run project (with correct signing & capabilities)
$
```

